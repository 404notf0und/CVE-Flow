# CVE EXP监控和预测

## Problems

首先明确下问题，文章标题包括3个子问题：

1. CVE增量监控；
2. CVE的EXP增量监控；
3. CVE的EXP预测，即预测刚爆出的CVE有EXP的可能性。

使用CVE 存量EXP数据，训练EXP预测模型，并持续监控获取增量EXP数据，重训练模型，不断迭代，以预测新增CVE的EXP可能性。

## Why

考虑做CVE增量监控的原因有这么几点，一是CVE是漏洞的事实标准，各大安全公司、厂商、人员常以CVE发布预警，二是漏洞的时效性对安全至关重要，相较于已知的存量CVE，新增的CVE相对不可控，潜在的危害可能更大，更快发布漏洞预警，挽回的损失更多。三是现有CVE监控手段的局限性，比如普渡大学公开的CVE监控工具The Cassandra Tool：https://cassandra.cerias.purdue.edu/CVE_changes/today.html，安全人员和安全工具常依赖此公开服务，直接获取最新CVE数据，默认信任了底层基础设施。解析并对比了国家漏洞数据库nvd每日发布的漏洞数据集https://nvd.nist.gov/vuln/data-feeds，发现普渡大学提供的CVE数据可能不准。不论公开的CVE监控工具还是商业化CVE监控服务，监控的都是nvd官方发布的数据源，因此考虑直接监控官方的第一手CVE数据源。

漏洞的两大要素：危害程度和被利用的难易程度。前者和后者共同决定了漏洞的威力，一定程度上，后者相当于给前者加了个权，更具有实际价值，应更受关注。高危的难利用漏洞和中危的易利用漏洞，考虑ROI，攻击者更可能利用易利用的中危漏洞。当然，如果高危漏洞的影响面很广，价值很高，就算再难利用也会有EXP，这时候ROI就另算了，攻击者还是会硬啃骨头。

漏洞的第三大要素是时间。无论是对甲方安全还是乙方安全，很多时候，拼的就是各种时间，甲乙方都关注的0day、1day、CVE爆发时间，甲方关注的漏洞修复时间，乙方关注的漏洞预警时间。同时考虑时间和被利用的难易程度两大漏洞要素，做CVE EXP的增量监控和预测，更具备实战意义。一方面，可以快速获取CVE最新爆出的EXP，另一方面，可以在CVE未爆出EXP之前，基于已知的存量和增量EXP数据，训练深度学习模型，提前预测CVE被利用的可能性，给安全人员提供CVE相关的辅助决策信息，更快产出价值。

## Result

1. 监控CVE和EXP当天增量的能力。
2. 产出一份CVE EXP标记数据集。截止到文章发布当天，通过多个漏洞数据源对CVE交叉打标，总计有66798个CVE被标记有EXP，且标记了EXP发布时间、来源和地址链接。
3. 基于深度学习的EXP预测模型的预测率目前稳定在80%-85%，可实战，可运营。
4. 整合了存量CVE数据分析、增量CVE和EXP监控、新增CVE EXP预警和可视化能力，形成一项CVE威胁情报服务，自动化产出CVE威胁报告并推送。

## What&Challenges

1. 标注数据集
2. 训练模型
3. 验证效果

## How

## Do

