import os
import datetime
import random
def path(*paths):
    """
    计算目录及文件的绝对路径
    """
    dir_name=os.path.dirname(os.path.realpath(__file__))
    return os.path.abspath(os.path.join(dir_name,*paths))

def time_delta(delta=0,format='%Y%m%d'):
    """
    时间操作函数
    """
    date=(datetime.date.today()+datetime.timedelta(days=delta)).strftime(format)
    return date

def list2tuple_dict(l,label):
    """
    列表转元组字典，以便插入sqlite3
    """
    d=dict()
    for i in l:
        s=(i,label)
        d[i]=s
    return d

def merge_dict(x,y):
    """
    将字典x合并入字典y
    """
    for k,v in x.items():
        if k in y.keys(): 
            y[k]=str(y[k])+";"+str(v)
        else:
            y[k] = v
    return y

def dict_sort(dt,key=True,value=False,desc=True):
    """
    默认按key增序
    """
    sorted_dict={}
    if key:
        for key in sorted(dt.keys(),reverse=desc):
            sorted_dict[key]=dt[key]
    if value:
        tup_dict=sorted(dt.items(),key = lambda x:x[1],reverse = desc) # 返回的是元组列表
        for k,v in tup_dict:
            sorted_dict[k]=v

    return sorted_dict

def get_ua():
    first_num = random.randint(55, 62)
    third_num = random.randint(0, 3200)
    fourth_num = random.randint(0, 140)
    os_type = [
        '(Windows NT 6.1; WOW64)', '(Windows NT 10.0; WOW64)', '(X11; Linux x86_64)',
        '(Macintosh; Intel Mac OS X 10_12_6)'
    ]
    chrome_version = 'Chrome/{}.0.{}.{}'.format(first_num, third_num, fourth_num)

    ua = ' '.join(['Mozilla/5.0', random.choice(os_type), 'AppleWebKit/537.36',
                   '(KHTML, like Gecko)', chrome_version, 'Safari/537.36']
                  )
    return ua

if __name__=="__main__":
    print(get_ua())
