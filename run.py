import os
import time
import requests
from bs4 import BeautifulSoup
modified_time=[]
def realtime_update():
        url="https://nvd.nist.gov/vuln/data-feeds"
        try:
                res=requests.get(url)
                html=res.content
                soup=BeautifulSoup(html,'html.parser')
                tr=soup.find_all('tr',class_='xml-feed-desc-row')
                modified_tr=tr[1]
                td=modified_tr.find_all('td')
                modified_td=td[1]
                epoch_time=modified_td.text
        except Exception as e:
        	print("[!] DOWNLOAD ERROR %s error:%s" %(url,repr(e)))
        	epoch_time=None
        return epoch_time

def periodic_monitor():
	while True:
		epoch_time=realtime_update()
		if epoch_time not in modified_time:
			print('[+] epoch_time:%s' %epoch_time)
			modified_time.append(epoch_time)
			cmd='python3 cve_flow.py'
			ret=os.system(cmd)
			print(ret)
		else:
			print('[+] skip epoch_time:%s' %epoch_time)
			time.sleep(300)

periodic_monitor()
